---
import Layout from '../../layouts/Layout.astro';
import { getEntry, render } from 'astro:content';
import { type CollectionEntry } from 'astro:content';
import HomeHero from '../../components/HomeHero.astro';
import HomeWhatWeDo from '../../components/HomeWhatWeDo.astro';
import HomeAICapabilities from '../../components/HomeAICapabilities.astro';
import HomeHowWeWork from '../../components/HomeHowWeWork.astro';
import HomeProjectsTeaser from '../../components/HomeProjectsTeaser.astro';
import HomeToolsTeaser from '../../components/HomeToolsTeaser.astro';
import HomeContactCTA from '../../components/HomeContactCTA.astro';
import { breadcrumbListJsonLd } from '../../lib/seo/structuredData';

const homeEntry: CollectionEntry<'pagesEn'> | undefined = await getEntry('pagesEn', 'en/home');

if (!homeEntry) {
  return new Response('Home page content not found', { status: 404 });
}

const { data } = homeEntry;
const { Content } = await render(homeEntry);

const site = Astro.site ?? new URL('https://devisia.pro');
const breadcrumbs = breadcrumbListJsonLd({
  site,
  items: [{ name: 'Home', url: '/en/' }],
});
---

<Layout title={data.title} description={data.description} heroImage={data.heroImage} lang="en" structuredData={[breadcrumbs]}>
  <HomeHero
    lang="en"
    heroTitle={data.heroTitle ?? 'Developing intelligent vision'}
    heroSubtitle={data.heroSubtitle ?? 'Devisia builds SaaS products and custom software solutions.'}
    heroImage={data.heroImage}
  >
    <Content />
  </HomeHero>

  <div class="ds-stack" data-gap="lg" style="container-type: inline-size; margin-top: var(--ds-space-8)">
    <HomeWhatWeDo
      lang="en"
      title={data.homeWhatWeDoTitle}
      description={data.homeWhatWeDoDescription}
      cards={data.homeWhatWeDoCards ?? undefined}
    />

    <HomeAICapabilities
      lang="en"
      title={data.homeAICapabilitiesTitle}
      description={data.homeAICapabilitiesDescription}
      items={data.homeAICapabilitiesItems ?? undefined}
      ctaLabel={data.homeAICapabilitiesCtaLabel ?? undefined}
      ctaHref={data.homeAICapabilitiesCtaHref ?? undefined}
    />

    <HomeHowWeWork
      lang="en"
      title={data.homeHowWeWorkTitle}
      description={data.homeHowWeWorkDescription}
      items={data.homeHowWeWorkItems ?? undefined}
    />

    <HomeProjectsTeaser
      lang="en"
      title={data.homeProjectsTitle}
      description={data.homeProjectsDescription}
      image={data.homeProjectsImage ?? undefined}
    />

    <HomeToolsTeaser lang="en" />

    <HomeContactCTA
      lang="en"
      title={data.homeContactTitle}
      description={data.homeContactDescription}
    />
  </div>
</Layout>
