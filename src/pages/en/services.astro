---
import Layout from '../../layouts/Layout.astro';
import { getEntry, render } from 'astro:content';
import { type CollectionEntry } from 'astro:content';
import { breadcrumbListJsonLd } from '../../lib/seo/structuredData';
import PageHero from '../../components/PageHero.astro';

const servicesEntry: CollectionEntry<'pagesEn'> | undefined = await getEntry(
  'pagesEn',
  'en/services'
);

if (!servicesEntry) {
  return new Response('Services page content not found', { status: 404 });
}

const { data } = servicesEntry;
const { Content } = await render(servicesEntry);

const site = Astro.site ?? new URL('https://devisia.pro');
const breadcrumbs = breadcrumbListJsonLd({
  site,
  items: [
    { name: 'Home', url: '/en/' },
    { name: data.title, url: '/en/services' },
  ],
});
---

<Layout
  title={data.title}
  description={data.description}
  heroImage={data.heroImage}
  lang="en"
  structuredData={[breadcrumbs]}
>
  <article class="ds-stack" data-gap="lg" style="container-type: inline-size">
    <PageHero
      lang="en"
      title={data.heroTitle ?? 'Services'}
      subtitle={data.heroSubtitle ?? data.description}
      image={data.heroImage}
      fallbackImage="/images/hero-about.svg"
      primaryHref="/en/contact"
      primaryLabel="Get in touch"
      secondaryHref="/en/projects"
      secondaryLabel="See projects"
    />
    <Content />
  </article>
</Layout>
